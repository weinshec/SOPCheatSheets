\ProvidesFile{cheatsheet.sty}
\ProvidesPackage{cheatsheet}

%______________________________________________________________________________
%                                                                META VARIABLES
\newcommand{\sopName}{sopName}
\newcommand{\sopVersion}{01--01--1970}
\newcommand{\sopRegion}{Rheinhessen \& Bad Kreuznach}
\newcommand{\sopDisclaimer}{%
  SOP cheatsheets sind \textbf{kein offizielles Dokument des ÄLRD} und stellen
  somit weder den Anspruch auf Vollständigkeit noch Korrektheit. Die für den
  Rettungsdienst bindenden und aktuellen SOPs finden sich unter
}
\newcommand{\sopURL}{http://rettungsdienst-rlp.de}
\newcommand{\sopEditor}{(xxx)}
\newcommand{\sopContent}{content}


%______________________________________________________________________________
%                                                                        BASICS
\usepackage[cmyk]{xcolor}
\usepackage{eso-pic}   % AddToShipoutPicture support
\usepackage{multicol}  % 2-columns


%______________________________________________________________________________
%                                                                        COLORS
\DefineNamedColor{named}{myBlue}{RGB}{32,109,252}
\DefineNamedColor{named}{myGrey}{RGB}{35, 33, 30}


%______________________________________________________________________________
%                                                                      GEOMETRY
\usepackage[driver=none]{geometry}
\geometry{%
  paperwidth=96mm,
  paperheight=135mm,
  textwidth=89mm,
  textheight=130mm,
  top=4mm,
  bottom=1mm,
  columnsep=4mm,
}

\usepackage{setspace}

\setlength{\parindent}{0em}
\setlength{\parskip}{0mm}


%______________________________________________________________________________
%                                                                         FONTS
\usepackage{fontspec}
\defaultfontfeatures{Path = fonts/}
\usepackage{fontawesome}

\setmainfont{SourceSansPro}[
  Mapping=tex-text,
  UprightFont={SourceSansPro-Light},
  ItalicFont={SourceSansPro-LightItalic},
  BoldFont={SourceSansPro-Semibold},
  BoldItalicFont={SourceSansPro-SemiboldItalic}
]

\newcommand{\fHead}[2]{%
  {\fontsize{#1}{#1}\selectfont\addfontfeature{LetterSpace=-2.0}\textbf{#2}}
}
\newcommand{\fTitle}[2]{%
  {\fontsize{#1}{#1}\selectfont\color{myBlue}#2}
}

\newcommand{\fsNormal}{\fontsize{10pt}{12pt plus 0.125pt minus 0.125pt}}
\newcommand{\fsSmall}{\fontsize{9pt}{11pt plus 0.125pt minus 0.125pt}}
\renewcommand{\normalsize}{\fsNormal\selectfont}
\renewcommand{\small}{\fsSmall\selectfont}


%______________________________________________________________________________
%                                                             IMAGES & GRAPHICS
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{shadows}


%______________________________________________________________________________
%                                                                  COMMON ITEMS
\newcommand{\puls}{\faHeartbeat{} }
\newcommand{\frau}{\faFemale}
\newcommand{\mann}{\faMale}
\newcommand{\erw}{\faMale\faFemale}
\newcommand{\kind}{\faChild}
\newcommand{\uhr}{\faClockO}
\newcommand{\zeit}{\faHourglassEnd}
\newcommand{\kein}{\faBan}
\newcommand{\arzt}{\faUserMd}
\newcommand{\tick}{\faCheck}
\newcommand{\herz}{\faHeartO}
\newcommand{\atmung}{\faMixcloud}
\newcommand{\wdh}{\faRepeat}
\newcommand{\ki}{\faSignIn}

\newcommand{\degC}{$^{\circ}$C}

\newcommand{\dosierung}[1]{\centerline{\textbf{#1}}}
\newenvironment{kontraindikationen}
  {\begin{itemize}\renewcommand{\labelitemi}{\ki}}
  {\end{itemize}}


% --- tables -----------------------------------------------------------
\usepackage{booktabs}
\usepackage{multirow}


%______________________________________________________________________________
%                                                                    BACKGROUND
\newcommand{\background}{}
\AddToShipoutPicture{\background}

\renewcommand{\background}{%
  \begin{tikzpicture}[
    remember picture,
    overlay,
    every node/.style={color=white, align=center},
    title/.style={minimum width=\paperwidth, fill=white}
  ]
    % background color
    \fill[myGrey] (0,0) rectangle (\paperwidth,\paperheight);

    % Draw header on first page
    \ifnum\thepage=1\relax

      \fill[myBlue]
        (\paperwidth,\paperheight) rectangle ++(-\paperwidth,-38mm);

      \node[anchor=north] at (0.27\paperwidth,\paperheight-1mm) {%
          \fHead{42pt}{SOP}\\
          \fHead{27pt}{CHEAT}\\
          \fHead{27pt}{SHEET}\\
          \textbf{\sopRegion}\\[2mm]
          \parbox[b]{10mm}{\fontsize{7pt}{7pt}\selectfont\raggedleft{version}}
          \parbox[b]{20mm}{\fontsize{11pt}{11pt}\selectfont\sopVersion}
          \parbox[b]{10mm}{\fontsize{7pt}{7pt}\selectfont\sopEditor}
      };

      \node[anchor=north] at (0.75\paperwidth,\paperheight-1mm) {%
        Disclaimer\\[2mm]
        \parbox{0.42\paperwidth}{%
          \setstretch{1.5}\fontsize{7pt}{7pt}\selectfont
          \textit{\sopDisclaimer}
        }\\[3mm]
        \sopURL
      };

      \node[title, anchor=north] (title) at (0.5\paperwidth, \paperheight-38mm) {%
        \fTitle{20pt}{\sopName}
      };
      \draw[color=myBlue, ultra thick] (title.south west)--(title.south east);

    % Draw headline on 2+ pages
    \else
      \fill[myBlue]
        (\paperwidth,\paperheight) rectangle ++(-\paperwidth,-1mm);
    \fi

    % Footline
    \fill[myBlue]
      (0,0) rectangle ++(\paperwidth,1mm);

  \end{tikzpicture}
}


%______________________________________________________________________________
%                                                                     STRUCTURE

\newcommand{\sopHeadSkip}{\vspace*{39mm}}

\usepackage[framemethod=tikz]{mdframed}
\newmdenv[
  backgroundcolor=white,
  roundcorner=4pt,
  frametitlefont=\fontsize{15pt}{15pt}\selectfont\color{myBlue},
  frametitlerule=true,
  frametitlerulewidth=0.3mm,
  frametitlerulecolor=myBlue,
  frametitleaboveskip=2mm,
  frametitlebelowskip=1mm,
  innertopmargin=3mm,
  innerbottommargin=3mm,
  skipbelow=-0.5mm,
  leftmargin=-2mm,
  rightmargin=-2mm,
  innerleftmargin=4mm,
  innerrightmargin=4mm,
]{sopSection}

\newcommand{\drug}[2]{%
  \begin{sopSection}[frametitle={#1}]
    #2
  \end{sopSection}
}

\newcommand{\notes}[1]{%
  \begin{sopSection}[frametitle={}]
    #1
  \end{sopSection}
}
